 <!-- START OF ORDER FORM SECTION -->
<div class="mt-10">
  <h2 class="text-2xl font-bold mb-4 text-white">Place Your Order</h2>
  <form id="orderForm" class="bg-white p-6 rounded-xl shadow-md space-y-4" netlify>
    <div>
      <label for="name" class="block text-gray-700">Full Name</label>
      <input type="text" name="name" id="name" required class="w-full mt-1 p-2 border rounded" />
    </div>
    <div>
      <label for="phone" class="block text-gray-700">Phone Number</label>
      <input type="tel" name="phone" id="phone" required class="w-full mt-1 p-2 border rounded" />
    </div>
    <div>
      <label for="address" class="block text-gray-700">Delivery Address</label>
      <textarea name="address" id="address" required class="w-full mt-1 p-2 border rounded"></textarea>
    </div>

    <div id="productContainer">
      <div class="productRow flex items-center gap-2 mb-2">
        <select name="products[]" class="productSelect w-full p-2 border rounded" required>
          <option value="" disabled selected>Select a product</option>
          <option value="Kush Gummies">Kush Gummies</option>
          <option value="Kush Ice Cream">Kush Ice Cream</option>
          <option value="Kush Bites Cookies">Kush Bites Cookies</option>
          <option value="Kush Glazed Popcorn">Kush Glazed Popcorn</option>
          <option value="Kush Shawarma">Kush Shawarma</option>
        </select>
        <input type="number" name="quantity[]" placeholder="Qty" min="1" class="w-20 p-2 border rounded" required />
      </div>
    </div>

    <button type="button" id="addProduct" class="text-sm text-green-600 underline">+ Add another product</button>

    <div>
      <label for="payment" class="block text-gray-700">Upload Payment Receipt</label>
      <input type="file" name="payment" id="payment" accept="image/*,application/pdf" required class="w-full mt-1 p-2 border rounded" />
    </div>

    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded">Submit Order</button>
  </form>
</div>

<script>
  const productList = [
    "Kush Gummies",
    "Kush Ice Cream",
    "Kush Bites Cookies",
    "Kush Glazed Popcorn",
    "Kush Shawarma"
  ];

  const productContainer = document.getElementById("productContainer");
  const addProductBtn = document.getElementById("addProduct");

  function getSelectedProducts() {
    return Array.from(document.querySelectorAll(".productSelect")).map(select => select.value);
  }

  function createProductRow() {
    const selected = getSelectedProducts();
    const row = document.createElement("div");
    row.className = "productRow flex items-center gap-2 mb-2";

    const select = document.createElement("select");
    select.name = "products[]";
    select.className = "productSelect w-full p-2 border rounded";
    select.required = true;

    const defaultOption = document.createElement("option");
    defaultOption.disabled = true;
    defaultOption.selected = true;
    defaultOption.textContent = "Select a product";
    select.appendChild(defaultOption);

    productList.forEach(product => {
      if (!selected.includes(product)) {
        const option = document.createElement("option");
        option.value = product;
        option.textContent = product;
        select.appendChild(option);
      }
    });

    const qty = document.createElement("input");
    qty.type = "number";
    qty.name = "quantity[]";
    qty.placeholder = "Qty";
    qty.min = 1;
    qty.required = true;
    qty.className = "w-20 p-2 border rounded";

    const removeBtn = document.createElement("button");
    removeBtn.type = "button";
    removeBtn.innerHTML = "âž–";
    removeBtn.className = "text-red-500 text-lg";
    removeBtn.onclick = () => {
      row.remove();
      updateAllProductOptions();
    };

    row.appendChild(select);
    row.appendChild(qty);
    row.appendChild(removeBtn);

    productContainer.appendChild(row);
    updateAllProductOptions();
  }

  function updateAllProductOptions() {
    const selected = getSelectedProducts();
    const selects = document.querySelectorAll(".productSelect");

    selects.forEach(select => {
      const currentValue = select.value;
      select.innerHTML = "";

      const defaultOption = document.createElement("option");
      defaultOption.disabled = true;
      defaultOption.selected = !currentValue;
      defaultOption.textContent = "Select a product";
      select.appendChild(defaultOption);

      productList.forEach(product => {
        if (!selected.includes(product) || product === currentValue) {
          const option = document.createElement("option");
          option.value = product;
          option.textContent = product;
          option.selected = product === currentValue;
          select.appendChild(option);
        }
      });
    });
  }

  addProductBtn.addEventListener("click", createProductRow);

  document.getElementById("orderForm").addEventListener("submit", function(e) {
    setTimeout(() => {
      this.reset();
      productContainer.innerHTML = "";
      createProductRow();
    }, 1000);
  });
</script>
<!-- END OF ORDER FORM SECTION -->
